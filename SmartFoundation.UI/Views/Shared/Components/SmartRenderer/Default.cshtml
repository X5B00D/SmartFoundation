@model SmartFoundation.UI.ViewModels.SmartPage.SmartPageViewModel




<!-- ===== Form Panel ===== -->
@if (Model.Form is not null)
{
    <div x-data="{ open: true }" class="sf-panel">
        <div class="sf-panel-header">
            <h3 class="sf-panel-title">@Model.PanelTitle</h3>

            <div class="sf-panel-actions">
                <!-- تحديث -->
                <button type="button" class="btn-refresh" title="تحديث"
                        x-on:click="$dispatch('refresh-form')">
                    <i class="fa fa-rotate"></i>
                </button>

                <!-- تصغير -->
                <button type="button" class="btn-minimize" title="تصغير"
                        x-on:click="open = !open">
                    <span x-show="open">−</span>
                    <span x-show="!open">+</span>
                </button>

                <!-- إغلاق -->
                <button type="button" class="btn-close" title="إغلاق"
                        x-on:click="$el.closest('.sf-panel').remove()">
                    ×
                </button>
            </div>
        </div>

        <div class="sf-panel-body" x-show="open">
            @await Component.InvokeAsync("SmartForm", new { model = Model.Form })
        </div>
    </div>

     <div class="sf-panel-body" x-show="open">
            @await Component.InvokeAsync("SmartDatePicker", new { model = Model.DatePicker })
        </div>
        
}

<!-- ===== Table Panel ===== -->
@if (Model.Table is not null)
{
    <div x-data="{ open: true, loading: false }" class="sf-panel relative">

        <div class="sf-panel-header">
            <h3 class="sf-panel-title">@Model.PanelTitle</h3>

            <div class="sf-panel-actions">
                <!-- تحديث -->
                <button type="button" class="btn-refresh" title="تحديث"
                        x-on:click="$dispatch('refresh-table')">
                    <i class="fa fa-rotate"></i>
                </button>

                <!-- تصغير -->
                <button type="button" class="btn-minimize" title="تصغير"
                        x-on:click="open = !open">
                    <span x-show="open">−</span>
                    <span x-show="!open">+</span>
                </button>

                <!-- إغلاق -->
                <button type="button" class="btn-close" title="إغلاق"
                        x-on:click="$el.closest('.sf-panel').remove()">
                    ×
                </button>
            </div>
        </div>

        <div class="sf-panel-body" x-show="open">
            @await Component.InvokeAsync("SmartTable", new { model = Model.Table })
        </div>
    </div>
}

@if (Model.TableDS is not null)
{
    <div x-data="{ open: true }" class="sf-panel">

        <!-- Header -->
        <div class="sf-panel-header flex items-center justify-between border-b border-gray-300">

            <h3 class="sf-panel-title flex items-center gap-2">
                <i class="fa-solid @(Model.PanelIcon ?? "fa-layer-group") text-emerald-600 text-sm"></i>
                @Model.PanelTitle
            </h3>


            <!-- أيقونات التحكم -->
            <div class="flex items-center gap-2 text-gray-500">


                <!-- تصغير -->
                <button type="button"

                        x-on:click="open = !open"
                        class="hover:text-gray-700 transition"
                        x-bind:title="open ? 'تصغير' : 'إظهار'">
                    <i class="fa-solid"
                       x-bind:class="open ? 'fa-minus' : 'fa-plus'"></i>

                </button>

                <button type="button"
                        x-on:click="$el.closest('.sf-panel').classList.toggle('sf-panel-full')"
                        class="hover:text-gray-700 transition"
                        title="ملء الشاشة">
                    <i class="fa-solid fa-expand"></i>
                </button>

                <!-- إغلاق -->
                <button type="button"
                        x-on:click="$el.closest('.sf-panel').remove()"
                        class="hover:text-red-600 transition"
                        title="إغلاق">
                    <svg xmlns="http://www.w3.org/2000/svg"
                         class="w-4 h-4"
                         fill="none"
                         viewBox="0 0 24 24"
                         stroke="currentColor">
                        <path stroke-linecap="round"
                              stroke-linejoin="round"
                              stroke-width="2"
                              d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>

            </div>
        </div>

        <!-- Body -->
        
        <div class="sf-panel-body"
             x-show="open"
             x-transition:enter="transition ease-out duration-200"
             x-transition:enter-start="opacity-0 scale-95"
             x-transition:enter-end="opacity-100 scale-100"
             x-transition:leave="transition ease-in duration-150"
             x-transition:leave-start="opacity-100 scale-100"
             x-transition:leave-end="opacity-0 scale-95">

            @await Component.InvokeAsync("SmartTableDS", new { model = Model.TableDS })
        </div>

    </div>
}
